"use strict";function AnalyticsEvent(a){this.name=a,this.timestamp=(new Date).toISOString(),this.sessionID=null,delete this.sessionID,this.properties={}}function Analytics(a){this.backend=a,this.sessionID=null,this._events=[],this.getSessionId=function(){return this.sessionID},this.startSession=function(){null==this.sessionID&&(this.sessionID=mcs._Utils.uuid(),this.logNamedEvent("sessionStart").type="system")},this.endSession=function(a,b){null!=this.sessionID&&(this.logNamedEvent("sessionEnd").type="system",mcs._Logger.log("Deactivate a default session"),this.flush(a,b),this.sessionID=null)},this.logNamedEvent=function(a){var b=new mcs.AnalyticsEvent(a);return this.logEvent(b),b},this.logEvent=function(a){return 0==this._events.length&&(this._events[0]=this._createContextEvent()),this.startSession(),this._events[this._events.length]=a,a.sessionID=this.sessionID,a},this.flush=function(a,b){for(var c=0;c<this._events.length;c++)if("context"==this._events[c].name){var d=mcs.MobileBackendManager.platform.getGPSLocation();null!=d&&null!=d.latitude&&(this._events[c].properties.latitude=d.latitude),null!=d&&null!=d.longitude&&(this._events[c].properties.longitude=d.longitude)}var e=JSON.stringify(this._events),f=this,g=f.backend.getHttpHeaders();g["Content-Type"]="application/json",g["Content-Length"]=e.length,mcs.MobileBackendManager.platform.invokeService({method:"POST",url:f.backend.getPlatformUrl("analytics/events"),headers:g,body:e,success:function(){mcs._Logger.log("Analytics events flushed."),f._events=[],null!=a&&a()},error:function(a,c){mcs._Logger.log("Failed to flush analytics events."),null!=b&&b(a,c)}})},this._createContextEvent=function(){var a=new mcs.AnalyticsEvent("context");a.type="system",a.properties.timezone=""+60*(new Date).getTimezoneOffset();var b=mcs.MobileBackendManager.platform.getDeviceInformation();return a.properties.model=b.model,a.properties.manufacturer=b.manufacturer,a.properties.osName=b.osName,a.properties.osVersion=b.osVersion,a.properties.osBuild=b.osBuild,a.properties.carrier=b.carrier,a}}function Authorization(a,b,c){this.AuthenticationType=c,this.backend=b,this.config=a,this.token=null,this.authorizedUserName=null;var d=this;this.authenticateAnonymous=function(a,b){},this.authenticate=function(a,b,c,d){},this.isAuthorized=function(){return null!=this.token},this.isTokenValid=function(){return null!=this.token},this.refreshToken=function(a,b){},this.logout=function(){this.token=null,this.authorizedUserName=null},this.getCurrentUser=function(a,b){mcs.MobileBackendManager.platform.invokeService({method:"GET",url:d.backend.getPlatformUrl("users/~"),headers:d.backend.getHttpHeaders(),success:function(b,c){if(null!=a){var d=new mcs.User(c);null!=d.links&&delete d.links,a(b.status,d)}},error:function(a,c){null!=b&&b(a,c)}})},this._getHttpHeaders=function(a){}}function BasicAuthorization(a,b,c){function d(){o.setAccessToken(null),o.setAnonymousAccessToken(null),o.setIsAuthorized(!1),o.setIsAnonymous(!1),o.authorizedUserName=null}Authorization.call(this,a,b,mcs.AuthorizationTypeBasic);var e=mcs._Utils.validateConfiguration(a.backendId),f=mcs._Utils.validateConfiguration(a.anonymousToken),g=mcs._Utils.validateConfiguration(c),h="Authorization",i="Oracle-Mobile-Backend-Id",j="Oracle-Mobile-Application-Key",k=null,l=null,m=!1,n=!1,o=this;this.getAnonymousToken=function(){return f},this.getApplicationKey=function(){return g},this.getBackendId=function(){return e},this.getAccessToken=function(){return l},this.setAccessToken=function(a){l=a},this.getAnonymousAccessToken=function(){return k},this.setAnonymousAccessToken=function(a){k=a},this.getIsAuthorized=function(){return m},this.setIsAuthorized=function(a){m=a},this.getIsAnonymous=function(){return n},this.setIsAnonymous=function(a){n=a},this.backend=b,this.authenticate=function(a,b,c,e){if(o.logout(),!a||!b)return mcs._Logger.log(mcs.logLevelError,"Wrong username or password parameter"),void(e&&e(400,"Bad Request"));var f="Basic "+mcs._Utils.encodeBase64(a+":"+b);mcs.MobileBackendManager.platform.invokeService({url:o.backend.getPlatformUrl("users/login"),method:"GET",headers:{Authorization:f,"Oracle-Mobile-Backend-Id":o.getBackendId(),"Oracle-Mobile-Application-Key":o.getApplicationKey()},success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"User "+a+" logged in"),o.setIsAuthorized(!0),o.setIsAnonymous(!1),o.setAccessToken(f),o.authorizedUserName=a,null!=c&&c(b.status,d)},error:function(a,b){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),d(),null!=e&&e(a,b)}})},this.authenticateAnonymous=function(a,b){o.logout();var c="Basic "+o.getAnonymousToken();mcs.MobileBackendManager.platform.invokeService({url:o.backend.getPlatformUrl("users/login"),method:"GET",headers:{Authorization:c,"Oracle-Mobile-Backend-Id":o.getBackendId(),"Oracle-Mobile-Application-Key":o.getApplicationKey()},success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"User logged in anonymously "+b.status),o.setIsAuthorized(!0),o.setIsAnonymous(!0),o.setAnonymousAccessToken(c),null!=a&&a(b.status,d)},error:function(a,c){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),d(),null!=b&&b(a,c)}})},this.isTokenValid=function(){return null!==o.getAccessToken()&&"string"==typeof o.getAccessToken()?(mcs._Logger.log(mcs.logLevelInfo,"Authorization token is not null or empty"),!0):null==o.getAccessToken()&&"string"!=typeof o.getAccessToken()?(mcs._Logger.log(mcs.logLevelInfo,"Authorization token is null and/or empty"),!1):void 0},this.refreshToken=function(a,b){var c=o.isTokenValid();0==o.getIsAuthorized()&&c!==!0?null!==b&&b(401,"Please use the authenticate with username/password combination or authenticateAnonymous function before using refreshToken."):1==o.getIsAuthorized()&&1==c&&null!==a&&(mcs._Logger.log(mcs.logLevelError,"Authenticated token is valid, you do not need to refresh."),a(200,o.getAccessToken()))},this.logout=function(){o.authorizedUserName=null,o.setAccessToken(null),o.setAnonymousAccessToken(null),o.setIsAuthorized(!1),o.setIsAnonymous(!1)},this._getHttpHeaders=function(a){null!==o.getAccessToken()&&"string"==typeof o.getAccessToken()&&(a[h]=o.getAccessToken()),a[i]=o.getBackendId(),a[j]=o.getApplicationKey()},this._getAnonymousHttpHeaders=function(a){null!==o.getAnonymousAccessToken()&&"string"==typeof o.getAnonymousAccessToken()&&(a[h]=o.getAnonymousAccessToken()),a[i]=o.getBackendId(),a[j]=o.getApplicationKey()}}function OAuthAuthorization(a,b,c){Authorization.call(this,a,b,mcs.AuthenticationTypeOAuth);var d=mcs._Utils.validateConfiguration(a.clientId),e=mcs._Utils.validateConfiguration(a.clientSecret),f=mcs._Utils.validateConfiguration(c);if(a.hasOwnProperty("userIdentityDomainName"))var g=mcs._Utils.validateConfiguration(a.userIdentityDomainName);var h="Authorization",i="X-USER-IDENTITY-DOMAIN-NAME",j="Oracle-Mobile-Application-Key",k=null,l=null,m=null,n=!1,o=!1,p=this;this.backend=b,this.getClientId=function(){return d},this.getApplicationKey=function(){return f},this.getTenantName=function(){return g},this.getClientSecret=function(){return e},this.getAccessToken=function(){return l},this.setAccessToken=function(a){l=a},this.getAnonymousAccessToken=function(){return k},this.setAnonymousAccessToken=function(a){k=a},this.getIsAuthorized=function(){return n},this.setIsAuthorized=function(a){n=a},this.getIsAnonymous=function(){return o},this.setIsAnonymous=function(a){o=a},this.authenticate=function(a,b,c,d){if(p.logout(),!a||!b)return mcs._Logger.log(mcs.logLevelError,"Wrong username or password parameter"),void(d&&d(400,"Bad Request"));var e="Basic "+mcs._Utils.encodeBase64(p.getClientId()+":"+p.getClientSecret()),f=r(a,b),g={};g["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",g[h]=e,g[j]=p.getApplicationKey(),"undefined"!=typeof p.getTenantName()&&(g[i]=p.getTenantName()),mcs.MobileBackendManager.platform.invokeService({url:p.backend.getOAuthTokenUrl(),method:"POST",headers:g,body:f,success:function(b,d){mcs._Logger.log(mcs.logLevelInfo,"OAuth Token received and time before it expires in seconds"),p.setIsAnonymous(!0),p.setIsAuthorized(!1),p.authorizedUserName=a,p.setAccessToken(d.access_token),m=Date.now()+1e3*d.expires_in,null!=c&&c(b.status,d)},error:function(a,b){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),q(),null!=d&&d(a,b)}})},this.authenticateAnonymous=function(a,b){p.logout();var c="Basic "+mcs._Utils.encodeBase64(p.getClientId()+":"+p.getClientSecret()),d={};d["Content-type"]="application/x-www-form-urlencoded; charset=utf-8",d[h]=c,d[j]=p.getApplicationKey(),"undefined"!=typeof p.getTenantName()&&(d[i]=p.getTenantName()),mcs.MobileBackendManager.platform.invokeService({url:p.backend.getOAuthTokenUrl(),method:"POST",headers:d,body:"grant_type=client_credentials",success:function(b,c){mcs._Logger.log(mcs.logLevelInfo,"OAuth Token received and time before it expires in seconds"),p.setIsAnonymous(!0),p.setIsAuthorized(!0),p.setAnonymousAccessToken(c.access_token),m=Date.now()+1e3*c.expires_in,null!=a&&a(b.status,c)},error:function(a,c){mcs._Logger.log(mcs.logLevelError,"Login failed with error: "+a),q(),null!=b&&b(a,c)}})},this.isTokenValid=function(){null===p.getAccessToken()&&null===p.getAnonymousAccessToken()||mcs._Logger.log(mcs.logLevelVerbose,"OAuth Token is not null or empty");var a=Date.now();return a>=m?(mcs._Logger.log(mcs.logLevelInfo,"Token has expired"),!1):(mcs._Logger.log(mcs.logLevelVerbose,"Token is still valid"),!0)},this.logout=function(){p.authorizedUserName=null,p.setIsAnonymous(!1),p.setIsAuthorized(!1),p.setAccessToken(null),p.setAnonymousAccessToken(null),m=1e3*Date.now()},this.refreshToken=function(a,b){var c=p.isTokenValid();c!==!1?(null==p.getAccessToken()&&p.getIsAnonymous()!==!1&&null!=a&&(mcs._Logger.log(mcs.logLevelError,"Anonymous token is valid, you do not need to refresh."),a(200,p.getAnonymousAccessToken())),null==p.getAnonymousAccessToken()&&p.getIsAnonymous()!==!0&&null!=a&&(mcs._Logger.log(mcs.logLevelError,"Authenticated token is valid, you do not need to refresh."),a(200,p.getAccessToken()))):(mcs._Logger.log(mcs.logLevelError,"Token has expired or user has not been authenticate with the service."),null!=b&&b(401,"Please use the authenticate with username/password combination or authenticateAnonymous function before using refreshToken."))};var q=function(){p.authorizedUserName=null,p.setIsAnonymous(!1),p.setIsAuthorized(!1),p.setAccessToken(null),p.setAnonymousAccessToken(null),m=1e3*Date.now()},r=function(a,b){var c,d;return c=a.indexOf("@")>-1?encodeURIComponent(a).replace(/%20/g,"+"):encodeURIComponent(a).replace(/%5B/g,"[").replace(/%5D/g,"]"),d=b.indexOf("&")>-1?encodeURIComponent(b).replace(/%20/g,"+"):encodeURIComponent(b).replace(/%5B/g,"[").replace(/%5D/g,"]"),"grant_type=password&username="+c+"&password="+d};this._getHttpHeaders=function(a){null!==p.getAccessToken()&&"string"==typeof p.getAccessToken()&&(a[h]="Bearer "+p.getAccessToken()),a[j]=p.getApplicationKey()},this._getAnonymousHttpHeaders=function(a){null!==p.getAnonymousAccessToken()&&"string"==typeof p.getAnonymousAccessToken()&&(a[h]="Bearer "+p.getAnonymousAccessToken()),a[j]=p.getApplicationKey()}}function User(a){var b=a.id,c=a.username,d=a.firstName,e=a.lastName,f=a.email,g={};for(var h in a)["id","username","firstName","lastName","email"].indexOf(h)<0&&(g[h]=a[h]),null!=g.links&&delete g.links;this.getId=function(){return b},this.getUsername=function(){return c},this.setUsername=function(a){c=a},this.getProperties=function(){return g},this.setProperties=function(a,b){var c=this.getProperties(),d=a.split(/\./);d.length<2?c[d[0]]=b:(c[d[0]]||(c[d[0]]={}),c=c[d.shift()],this.setProperties(d.join("."),b))},this.getFirstName=function(){return d},this.setFirstName=function(a){d=a},this.getLastName=function(){return e},this.setLastName=function(a){e=a},this.getEmail=function(){return f},this.setEmail=function(a){f=a}}function Diagnostics(a){this.backend=a,this._sessionId=mcs._Utils.uuid(),this._getHttpHeaders=function(a){a["Oracle-Mobile-DIAGNOSTIC-SESSION-ID"]=this.getSessionId(),a["Oracle-Mobile-DEVICE-ID"]=mcs.MobileBackendManager.platform.getDeviceId(),a["Oracle-Mobile-CLIENT-REQUEST-TIME"]=(new Date).toISOString()},this.getSessionId=function(){return this._sessionId}}function CustomCode(a){this.backend=a;var b=this;this.invokeCustomCodeJSONRequest=function(a,c,d,e,f){var g=b.backend.getHttpHeaders();g["Content-Type"]="application/json";var h=JSON.stringify(d);g["Content-Length"]=h.length,mcs.MobileBackendManager.platform.invokeService({method:c,url:b.backend.getCustomCodeUrl(a),headers:g,body:h,success:function(a,b){null!=e&&e(a.status,b)},error:function(a,b){null!=f&&f(a,b)}})}}function MobileBackend(a,b){function c(a,b){return a.match(b+"$")==b}var d="mobile/platform",e="mobile/custom",f=null,g=this;this.name=a,this._config=b,this.getAuthenticationTypeVariable=function(){return f},this.setAuthenticationTypeVariable=function(a){f=a},this.getPlatformUrl=function(a){var b=this._config.baseUrl;return"ssoAuth"==g.getAuthenticationTypeVariable()&&c(this._config.baseUrl,"1")&&(b=b.substring(0,b.length-4)+"7777"),b=mcs._Utils.validateConfiguration(b)+"/"+d,c(b,"/")||(b+="/"),b+a},this.getCustomCodeUrl=function(a){var b=mcs._Utils.validateConfiguration(this._config.baseUrl)+"/"+e;return c(a,"/")||(b+="/"),b+a},this.getOAuthTokenUrl=function(){var a=mcs._Utils.validateConfiguration(this._config.authorization.oAuth.tokenEndpoint);return c(a,"/")||(a+="/"),a},this.getSSOAuthTokenUrl=function(){var a=mcs._Utils.validateConfiguration(this._config.authorization.ssoAuth.tokenEndpoint);return c(a,"/")||(a+="/"),a},this.getHttpHeaders=function(a){return null==a&&(a={}),this.Diagnostics._getHttpHeaders(a),this.Authorization.getIsAuthorized()!==!1&&this.Authorization.getIsAnonymous()!==!1?this.Authorization._getAnonymousHttpHeaders(a):this.Authorization._getHttpHeaders(a),a},this.setAuthenticationType=function(a){var b=mcs._Utils.validateConfiguration(a);if(this.Authorization=null,!this._config.authorization.hasOwnProperty(b))throw mcs._Logger.Exception("No Authentication Type called "+a+" is defined in MobileBackendManager.config \ncheck MobileBackendManager.config in authorization object for the following objects:\n"+mcs.AuthenticationTypeBasic+"\n"+mcs.AuthenticationTypeOAuth+"\n"+mcs.AuthenticationTypeFacebook+"\n"+mcs.AuthenticationTypeSSO);return null!==this.Authorization&&this.Authorization.getIsAuthorized()!==!1&&this.Authorization.logout(),b==mcs.AuthenticationTypeBasic?(this.Authorization=new mcs._BasicAuthorization(this._config.authorization.basicAuth,this,this._config.applicationKey),mcs._Logger.log(mcs.logLevelInfo,"Your Authentication type: "+b),g.setAuthenticationTypeVariable(b)):b==mcs.AuthenticationTypeOAuth?(this.Authorization=new mcs._OAuthAuthorization(this._config.authorization.oAuth,this,this._config.applicationKey),mcs._Logger.log(mcs.logLevelInfo,"Your Authentication type: "+b),g.setAuthenticationTypeVariable(b)):b==mcs.AuthenticationTypeFacebook?(this.Authorization=new mcs._FacebookAuthorization(this._config.authorization.facebookAuth,this,this._config.applicationKey),mcs._Logger.log(mcs.logLevelInfo,"Your Authentication type: "+b),g.setAuthenticationTypeVariable(b)):b==mcs.AuthenticationTypeSSO&&(this.Authorization=new mcs._SSOAuthorization(this._config.authorization.ssoAuth,this,this._config.applicationKey),mcs._Logger.log(mcs.logLevelInfo,"Your Authentication type: "+b),g.setAuthenticationTypeVariable(b)),this.Authorization},this.getAuthenticationType=function(){return this.Authorization},this.Diagnostics=new mcs._Diagnostics(this),this.CustomCode=new mcs.CustomCode(this),this.Analytics=new mcs._Analytics(this),this.Storage=new mcs._Storage(this),mcs._Notifications&&(this.Notifications=new mcs._Notifications(this)),this.AppConfig={},this.loadAppConfig=function(a,b){g.Authorization.isAuthorized?g._loadAppConfig(a,b):g.Authorization.authenticateAnonymous(function(){g._loadAppConfig(a,b)},b)},this._loadAppConfig=function(a,b){var c=g.getHttpHeaders();c["Content-Type"]="application/json",mcs.MobileBackendManager.platform.invokeService({method:"GET",url:g.getPlatformUrl("appconfig/client"),headers:c,success:function(b,c){mcs._Logger.log(mcs.logLevelInfo,"New WebStarterApp config downloaded with status code: "+b.status),g.AppConfig=c,null!=a&&a(b.status,g.AppConfig)},error:function(a,c){mcs._Logger.log(mcs.logLevelError,"App config download failed! with status code: "+a),null!=b&&b(a,c)}})}}function StorageObject(a,b){function c(a,b,c,d){null!=d&&(c.setPayload(b),c.name=decodeURI(a.getResponseHeader("Oracle-Mobile-Name")),c._eTag=a.getResponseHeader("ETag"),c.contentLength=b.size,c.contentType=a.getResponseHeader("Content-Type"),c.createdBy=a.getResponseHeader("Oracle-Mobile-Created-By"),c.createdOn=a.getResponseHeader("Oracle-Mobile-Created-On"),c.modifiedBy=a.getResponseHeader("Oracle-Mobile-Modified-By"),c.modifiedOn=a.getResponseHeader("Oracle-Mobile-Modified-On"),d(c))}function d(a,b,c){null!=c&&c(a,b)}var e=a,f=null;null!=b&&(this.id=b.id,this.name=b.name,this.contentLength=b.contentLength,this.contentType=b.contentType,this._eTag=b.eTag,this.createdBy=b.createdBy,this.createdOn=b.createdOn,this.modifiedBy=b.modifiedBy,this.modifiedOn=b.modifiedOn),this.getPayload=function(){return f},this.setPayload=function(a){f=a},this.getstorageCollection=function(){return e},this.getStorage=function(){return this.getstorageCollection()._storage},this.loadPayload=function(a,b){f=a,this.contentType=b,"text/plain"==this.contentType?"string"==typeof f&&(f=a):"application/json"==this.contentType&&("string"==typeof f?f=a:"object"==typeof f&&(f=JSON.stringify(a))),this.contentLength=f.length},this.setDisplayName=function(a){this.name=a},this.getDisplayName=function(){return this.name},this.readPayload=function(a,b,e){if(null==this.getPayload()){var f=this,g=f.getstorageCollection().getStorage().backend.getHttpHeaders();g["Accept-Encoding"]="gzip";var h="storage/collections/"+f.getstorageCollection().id+"/objects/"+this.id;null!=f.getstorageCollection().userId&&f.getstorageCollection()._userIsolated&&(h+="?user="+f.getstorageCollection().userId),mcs.MobileBackendManager.platform.invokeService({method:"GET",url:f.getstorageCollection().getStorage().backend.getPlatformUrl(h),headers:g,responseType:e||"blob",success:function(b,d){c(b,d,f,a)},error:function(a,c){d(a,c,b)}})}}}function StorageCollection(a,b,c){var d=c,e=mcs._Utils.validateConfiguration(b),f=a,g=this;this.getStorage=function(){return d},this.getUserId=function(){return e},this.getData=function(){return f},this.id=this.getData().id,this.description=this.getData().description,this._userIsolated=this.getData().userIsolated,this.getObjects=function(a,b,c,d){var e=g.getStorage().backend.getHttpHeaders();e.Accept="application/json",e["Accept-Encoding"]="gzip";var f="storage/collections/"+g.id+"/objects";null!=a&&(f+=f.indexOf("?")==-1?"?":"&",f+="offset="+a),null!=b&&(f+=f.indexOf("?")==-1?"?":"&",f+="limit="+b),null!=g.getUserId()&&g._userIsolated&&(f+=f.indexOf("?")==-1?"?":"&",f+="user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"GET",url:g.getStorage().backend.getPlatformUrl(f),headers:e,success:function(a,b){if(null!=c){for(var d=[],e=b,f=0;f<e.items.length;f++)d[d.length]=new mcs.StorageObject(g,e.items[f]);c(d)}},error:function(a,b){null!=d&&d(a,b)}})},this.getObject=function(a,b,c,d){var e=new mcs.StorageObject(this);e.id=a,e.readPayload(function(a){null!=b&&b(e)},function(a,b){null!=c&&c(a,b)},d)},this.postObject=function(a,b,c){this._postOrPutStorageObject(a,!0,b,c)},this.putObject=function(a,b,c){this._postOrPutStorageObject(a,!1,b,c)},this._postOrPutStorageObject=function(a,b,c,d){var e=g.getStorage().backend.getHttpHeaders();e["Oracle-Mobile-Name"]=encodeURI(a.getDisplayName()),e["Accept-Encoding"]="gzip",e["Content-Type"]=a.contentType,e["Content-Length"]=a.contentLength;var f="storage/collections/"+g.id+"/objects";b||(f+="/"+a.id,null!=a._eTag&&(e["If-Match"]=a._eTag)),g._userIsolated&&null!=g.getUserId()&&(f+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:b?"POST":"PUT",url:g.getStorage().backend.getPlatformUrl(f),headers:e,body:a.getPayload(),success:function(a,b){if(null!=c){var d=new mcs.StorageObject(g,b);c(a.status,d)}},error:function(a,b){null!=d&&d(a,b)}})},this.contains=function(a,b,c){var d=g.getStorage().backend.getHttpHeaders(),e="storage/collections/"+g.id+"/objects/"+a;g._userIsolated&&null!=g.getUserId()&&(e+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"HEAD",url:g.getStorage().backend.getPlatformUrl(e),headers:d,success:function(a,c){null!=b&&b(a.status,c)},error:function(a,b){null!=c&&c(a,b)}})},this.deleteObject=function(a,b,c){var d=g.getStorage().backend.getHttpHeaders();d["If-Match"]="*";var e="storage/collections/"+g.id+"/objects/"+a;g._userIsolated&&null!=g.getUserId()&&(e+="?user="+g.getUserId()),mcs.MobileBackendManager.platform.invokeService({method:"DELETE",url:g.getStorage().backend.getPlatformUrl(e),headers:d,success:function(a,c){null!=b&&b(a.status,c)},error:function(a,b){null!=c&&c(a,b)}})}}function Storage(a){this.backend=a;var b=this;this.getCollection=function(a,c,d,e){var f=b.backend.getHttpHeaders();f.Accept="application/json",f["Accept-Encoding"]="gzip",mcs.MobileBackendManager.platform.invokeService({method:"GET",url:b.backend.getPlatformUrl("storage/collections/"+mcs._Utils.validateConfiguration(a)),headers:f,success:function(a,e){null!=d&&d(new mcs._StorageCollection(e,mcs._Utils.validateConfiguration(c),b))},error:function(a,b){null!=e&&e(a,b)}})}}!function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Logger=a.mcs._Logger||{}}(),mcs.logLevelError=1,mcs.logLevelInfo=2,mcs.logLevelVerbose=3,mcs._Logger.logLevel=mcs.logLevelInfo,mcs._Logger.Exception=function(a){this.message=a,this.name="Exception",console.log(this.name+" : "+this.message)},mcs._Logger.debug=function(a,b){console.log(a+" "+b)},mcs._Logger.log=function(a,b){mcs._Logger.logLevel>=a&&console.log(b)},function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Utils=a.mcs._Utils||{}}();var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";mcs._Utils.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},mcs._Utils.validateConfiguration=function(a){var b=a;return/\s/.test(b)&&void 0!=b&&(b=removeSpace(a)),b};var removeSpace=function(a){return a.replace(/ /g,"")};mcs._Utils.encodeBase64=function(a){var b,c,d,e,f,g="",h="",i="",j=0;do b=a.charCodeAt(j++),c=a.charCodeAt(j++),h=a.charCodeAt(j++),d=b>>2,e=(3&b)<<4|c>>4,f=(15&c)<<2|h>>6,i=63&h,isNaN(c)?f=i=64:isNaN(h)&&(i=64),g=g+keyStr.charAt(d)+keyStr.charAt(e)+keyStr.charAt(f)+keyStr.charAt(i),b=c=h="",d=e=f=i="";while(j<a.length);return g},mcs._Utils.decodeBase64=function(a){var b,c,d,e,f,g="",h="",i="",j=0,k=/[^A-Za-z0-9\+\/\=]/g;if(k.exec(a))return null;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=keyStr.indexOf(a.charAt(j++)),e=keyStr.indexOf(a.charAt(j++)),f=keyStr.indexOf(a.charAt(j++)),i=keyStr.indexOf(a.charAt(j++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,h=(3&f)<<6|i,g+=String.fromCharCode(b),64!=f&&(g+=String.fromCharCode(c)),64!=i&&(g+=String.fromCharCode(h)),b=c=h="",d=e=f=i="";while(j<a.length);return g},mcs._Utils.hasValue=function(a,b,c){return a.hasOwnProperty(b)&&a[b]===c};var _deviceId=mcs._Utils.uuid(),Platform=function(){this.invokeService=function(a){throw mcs._Logger.Exception("invokeService() not implemented in Platform!")},this.getDeviceId=function(){return _deviceId},this.getGPSLocation=function(){return{latitude:null,longitude:null}},this.getDeviceInformation=function(){return{model:"<unknown>",manufacturer:"<unknown>",osName:"<unknown>",osVersion:"<unknown>",osBuild:"<unknown>",carrier:"<unknown>"}},this._deviceState=mcs.DeviceState.unrestricted,this._deviceStateChangedCallbacks=[],this.setDeviceState=function(a){if(this._deviceState!=a){mcs._Logger.log(mcs.logLevelInfo,"Device state changing from "+this._deviceState+" to "+a),this._deviceState=a;for(var b=0;b<this._deviceStateChangedCallbacks.length;b++)this._deviceStateChangedCallbacks[b](this._deviceState)}},this.cacheCredentials=function(a,b){},this.validateCachedCredentials=function(a,b){return!1}};!function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.Platform=Platform;var b=a.mcs;b.DeviceState={offline:0,unrestricted:1,restricted:2,critical:3}}();var BrowserPlatform=function(){this.isBrowser=!0,this.isCordova=!1,this.invokeService=function(a){var b=new XMLHttpRequest;b.open(a.method,a.url);for(var c in a.headers)a.headers.hasOwnProperty(c)&&b.setRequestHeader(c,a.headers[c]);b.withCredentials=!0,b.responseType=a.responseType||"json",b.onreadystatechange=function(){if(4===b.readyState)if(b.status>=200&&b.status<=299){if(null!=a.success){var c=b.response;"string"==typeof b.response&&(c=""==b.response?{}:JSON.parse(b.response)),a.success(b,c)}}else null!=a.error&&a.error(b.status,b.response)},b.send(a.body)}};!function(){BrowserPlatform.prototype=new mcs.Platform;var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.BrowserPlatform=BrowserPlatform}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.AnalyticsEvent=AnalyticsEvent}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Analytics=Analytics}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.Authorization=Authorization,a.mcs.AuthenticationTypeBasic="basicAuth",a.mcs.AuthenticationTypeOAuth="oAuth",a.mcs.AuthenticationTypeSSO="ssoAuth",a.mcs.AuthenticationTypeFacebook="facebookAuth"}(),function(){BasicAuthorization.prototype=new mcs.Authorization;var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._BasicAuthorization=BasicAuthorization}(),function(){OAuthAuthorization.prototype=new mcs.Authorization;var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._OAuthAuthorization=OAuthAuthorization}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.User=User}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Diagnostics=Diagnostics}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.CustomCode=CustomCode}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._MobileBackend=MobileBackend}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{}}(),mcs.MobileBackendManager=mcs.MobileBackendManager||{},mcs.MobileBackendManager.platform=new mcs.BrowserPlatform,mcs.MobileBackendManager._config={mobileBackends:{}},mcs.MobileBackendManager._mobileBackends={},mcs.MobileBackendManager.setConfig=function(a){null!=a.logLevel&&(mcs._Logger.logLevel=a.logLevel),this._config=a,this._mobileBackends={}},mcs.MobileBackendManager.returnMobileBackend=function(a,b){return 0==mcs.MobileBackendManager.platform.isCordova?mcs.MobileBackendManager.platform=new mcs.CordovaPlatform:mcs.MobileBackendManager.platform=new mcs.BrowserPlatform,mcs._Logger.log(mcs.logLevelInfo,"The Cordova platform is set!"),mcs.MobileBackendManager.setConfig(b),mcs._Logger.log(mcs.logLevelInfo,"The config has been set and now it has the backend defined in the config as the point of entry for the rest of the functions you need to call."),mcs.MobileBackendManager.getMobileBackend(a)},mcs.MobileBackendManager.getMobileBackend=function(a){if(null!=this._mobileBackends[a])return this._mobileBackends[a];for(var b in this._config.mobileBackends)if(b==mcs._Utils.validateConfiguration(a)){var c=new mcs._MobileBackend(a,this._config.mobileBackends[a]);return this._mobileBackends[a]=c,c}return mcs._Logger.log(mcs.logLevelError,"No mobile backend called "+a+" is defined in MobileBackendManager.config"),null},function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs.StorageObject=StorageObject}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._StorageCollection=StorageCollection}(),function(){var a="undefined"!=typeof window?window:global;a.mcs=a.mcs||{},a.mcs._Storage=Storage}();